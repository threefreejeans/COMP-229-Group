var J=Object.create;var{getPrototypeOf:k,defineProperty:d,getOwnPropertyNames:y,getOwnPropertyDescriptor:O}=Object,f=Object.prototype.hasOwnProperty;var A=(e,s,o)=>{o=e!=null?J(k(e)):{};let n=s||!e||!e.__esModule?d(o,"default",{value:e,enumerable:!0}):o;for(let c of y(e))if(!f.call(n,c))d(n,c,{get:()=>e[c],enumerable:!0});return n},u=new WeakMap,N=(e)=>{var s=u.get(e),o;if(s)return s;if(s=d({},"__esModule",{value:!0}),e&&typeof e==="object"||typeof e==="function")y(e).map((n)=>!f.call(s,n)&&d(s,n,{get:()=>e[n],enumerable:!(o=O(e,n))||o.enumerable}));return u.set(e,s),s};var j=(e,s)=>{for(var o in s)d(e,o,{get:s[o],enumerable:!0,configurable:!0,set:(n)=>s[o]=()=>n})};var x={};j(x,{setupMessageHandler:()=>M});module.exports=N(x);var w=require("node:worker_threads"),g=require("node:fs"),l=require("node:path"),h=require("node:url"),a,p;function m(e){new Function(e).call(globalThis)}function L(){if(typeof globalThis.ELK==="undefined")try{let e=l.dirname(h.fileURLToPath(import.meta.url)),s=g.readFileSync(l.join(e,"elk.js"),"utf8"),o=g.readFileSync(l.join(e,"setup.js"),"utf8");m(s),m(o)}catch(e){throw console.error("Failed to load ELK library:",e),e}}function M(e,s,o){a=s;let n=async(c)=>{let{type:b,data:i}=c;switch(b){case"init":try{if(e)m(i.wasmExecContent);L(),p=await o(i.wasm),a.postMessage({type:"ready"})}catch(r){a.postMessage({type:"error",error:r.message})}break;case"compile":try{let r=await p.compile(JSON.stringify(i)),t=JSON.parse(r);if(t.error)throw new Error(t.error.message);a.postMessage({type:"result",data:t.data})}catch(r){a.postMessage({type:"error",error:r.message})}break;case"render":try{let r=await p.render(JSON.stringify(i)),t=JSON.parse(r);if(t.error)throw new Error(t.error.message);let S=new TextDecoder().decode(Uint8Array.from(atob(t.data),(E)=>E.charCodeAt(0)));a.postMessage({type:"result",data:S})}catch(r){a.postMessage({type:"error",error:r.message})}break;case"encode":try{let r=p.encode(i),t=JSON.parse(r);if(t.error)throw new Error(t.error.message);a.postMessage({type:"result",data:t.data.result})}catch(r){a.postMessage({type:"error",error:r.message})}break;case"decode":try{let r=p.decode(i),t=JSON.parse(r);if(t.error)throw new Error(t.error.message);a.postMessage({type:"result",data:t.data.result})}catch(r){a.postMessage({type:"error",error:r.message})}break;case"version":try{let r=p.version(),t=JSON.parse(r);if(t.error)throw new Error(t.error.message);a.postMessage({type:"result",data:t.data})}catch(r){a.postMessage({type:"error",error:r.message})}break;case"jsVersion":try{let r=p.jsVersion(),t=JSON.parse(r);if(t.error)throw new Error(t.error.message);a.postMessage({type:"result",data:t.data})}catch(r){a.postMessage({type:"error",error:r.message})}break}};if(e)s.on("message",n);else s.onmessage=(c)=>n(c.data)}async function T(e){let s=new Go,o=await WebAssembly.instantiate(e,s.importObject);return s.run(o.instance),global.d2}M(!0,w.parentPort,T);
